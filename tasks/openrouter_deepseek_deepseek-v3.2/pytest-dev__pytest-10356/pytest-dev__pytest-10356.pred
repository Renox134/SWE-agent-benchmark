{"model_name_or_path": "openrouter_deepseek_deepseek-v3.2", "instance_id": "pytest-dev__pytest-10356", "model_patch": "diff --git a/conftest.py b/conftest.py\nnew file mode 100644\nindex 000000000..9c5d69511\n--- /dev/null\n+++ b/conftest.py\n@@ -0,0 +1,7 @@\n+def pytest_configure(config):\n+    config.addinivalue_line(\"markers\", \"foo: foo marker\")\n+    config.addinivalue_line(\"markers\", \"bar: bar marker\")\n+    config.addinivalue_line(\"markers\", \"one: one marker\")\n+    config.addinivalue_line(\"markers\", \"two: two marker\")\n+    config.addinivalue_line(\"markers\", \"base1: base1 marker\")\n+    config.addinivalue_line(\"markers\", \"base2: base2 marker\")\n\\ No newline at end of file\ndiff --git a/reproduce_issue.py b/reproduce_issue.py\nnew file mode 100644\nindex 000000000..d5c86eb21\n--- /dev/null\n+++ b/reproduce_issue.py\n@@ -0,0 +1,68 @@\n+import pytest\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        # This test should have both markers, foo and bar.\n+        # In practice markers are resolved using MRO (so foo wins), unless the\n+        # metaclass is applied\n+        pass\n+\n+# Let's also test with a simpler case\n+@pytest.mark.one\n+class ClassOne:\n+    pass\n+\n+@pytest.mark.two\n+class ClassTwo:\n+    pass\n+\n+class TestMultipleInheritance(ClassOne, ClassTwo):\n+    def test_multiple_inheritance(self):\n+        pass\n+\n+# Test with deeper inheritance\n+@pytest.mark.base1\n+class Base1:\n+    pass\n+\n+@pytest.mark.base2\n+class Base2:\n+    pass\n+\n+class Middle(Base1):\n+    pass\n+\n+class TestDeepInheritance(Middle, Base2):\n+    def test_deep_inheritance(self):\n+        pass\n+\n+if __name__ == \"__main__\":\n+    # Let's inspect the markers\n+    import inspect\n+    \n+    print(\"TestDings markers:\", getattr(TestDings, 'pytestmark', []))\n+    print(\"TestMultipleInheritance markers:\", getattr(TestMultipleInheritance, 'pytestmark', []))\n+    print(\"TestDeepInheritance markers:\", getattr(TestDeepInheritance, 'pytestmark', []))\n+    \n+    # Also check the test function markers\n+    print(\"\\nChecking test function markers:\")\n+    for name, obj in inspect.getmembers(TestDings):\n+        if name.startswith('test_'):\n+            print(f\"{name} markers:\", getattr(obj, 'pytestmark', []))\n+    \n+    for name, obj in inspect.getmembers(TestMultipleInheritance):\n+        if name.startswith('test_'):\n+            print(f\"{name} markers:\", getattr(obj, 'pytestmark', []))\n+    \n+    for name, obj in inspect.getmembers(TestDeepInheritance):\n+        if name.startswith('test_'):\n+            print(f\"{name} markers:\", getattr(obj, 'pytestmark', []))\n\\ No newline at end of file\ndiff --git a/test_attribute_lookup.py b/test_attribute_lookup.py\nnew file mode 100644\nindex 000000000..89248c976\n--- /dev/null\n+++ b/test_attribute_lookup.py\n@@ -0,0 +1,31 @@\n+import pytest\n+\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    pass\n+\n+# Check if pytestmark is in TestDings.__dict__\n+print(\"'pytestmark' in TestDings.__dict__:\", 'pytestmark' in TestDings.__dict__)\n+print(\"'pytestmark' in Foo.__dict__:\", 'pytestmark' in Foo.__dict__)\n+print(\"'pytestmark' in Bar.__dict__:\", 'pytestmark' in Bar.__dict__)\n+\n+# Check what getattr returns\n+print(\"\\ngetattr(TestDings, 'pytestmark', []):\", getattr(TestDings, 'pytestmark', []))\n+print(\"getattr(Foo, 'pytestmark', []):\", getattr(Foo, 'pytestmark', []))\n+print(\"getattr(Bar, 'pytestmark', []):\", getattr(Bar, 'pytestmark', []))\n+\n+# Now test with a class that has its own pytestmark\n+@pytest.mark.direct\n+class TestWithDirectMark(Foo, Bar):\n+    pass\n+\n+print(\"\\n=== TestWithDirectMark ===\")\n+print(\"'pytestmark' in TestWithDirectMark.__dict__:\", 'pytestmark' in TestWithDirectMark.__dict__)\n+print(\"getattr(TestWithDirectMark, 'pytestmark', []):\", getattr(TestWithDirectMark, 'pytestmark', []))\n\\ No newline at end of file\ndiff --git a/test_duplicate_markers.py b/test_duplicate_markers.py\nnew file mode 100644\nindex 000000000..29509adb3\n--- /dev/null\n+++ b/test_duplicate_markers.py\n@@ -0,0 +1,15 @@\n+import pytest\n+\n+# Test if duplicate markers are allowed\n+@pytest.mark.foo\n+@pytest.mark.foo\n+def test_duplicate():\n+    pass\n+\n+# Check the markers\n+print(\"test_duplicate markers:\", getattr(test_duplicate, 'pytestmark', []))\n+\n+# Run pytest to see what happens\n+if __name__ == \"__main__\":\n+    import sys\n+    sys.exit(pytest.main([__file__, \"-v\"]))\n\\ No newline at end of file\ndiff --git a/test_markers_detailed.py b/test_markers_detailed.py\nnew file mode 100644\nindex 000000000..ca21d31ab\n--- /dev/null\n+++ b/test_markers_detailed.py\n@@ -0,0 +1,71 @@\n+import pytest\n+import inspect\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        pass\n+\n+# Let's also test with a simpler case\n+@pytest.mark.one\n+class ClassOne:\n+    pass\n+\n+@pytest.mark.two\n+class ClassTwo:\n+    pass\n+\n+class TestMultipleInheritance(ClassOne, ClassTwo):\n+    def test_multiple_inheritance(self):\n+        pass\n+\n+# Test with deeper inheritance\n+@pytest.mark.base1\n+class Base1:\n+    pass\n+\n+@pytest.mark.base2\n+class Base2:\n+    pass\n+\n+class Middle(Base1):\n+    pass\n+\n+class TestDeepInheritance(Middle, Base2):\n+    def test_deep_inheritance(self):\n+        pass\n+\n+# Let's trace what happens when we access pytestmark\n+print(\"Direct access to pytestmark attribute:\")\n+print(\"  Foo.pytestmark:\", getattr(Foo, 'pytestmark', []))\n+print(\"  Bar.pytestmark:\", getattr(Bar, 'pytestmark', []))\n+print(\"  TestDings.pytestmark:\", getattr(TestDings, 'pytestmark', []))\n+print()\n+\n+# Let's check the MRO\n+print(\"MRO for TestDings:\", TestDings.__mro__)\n+print()\n+\n+# Let's manually check what markers we would get if we followed MRO\n+def get_marks_via_mro(cls):\n+    marks = []\n+    for base in cls.__mro__:\n+        if hasattr(base, 'pytestmark'):\n+            base_marks = getattr(base, 'pytestmark', [])\n+            if not isinstance(base_marks, list):\n+                base_marks = [base_marks]\n+            marks.extend(base_marks)\n+    return marks\n+\n+print(\"Markers via MRO traversal:\")\n+print(\"  TestDings:\", get_marks_via_mro(TestDings))\n+print(\"  TestMultipleInheritance:\", get_marks_via_mro(TestMultipleInheritance))\n+print(\"  TestDeepInheritance:\", get_marks_via_mro(TestDeepInheritance))\n\\ No newline at end of file\ndiff --git a/test_markers_direct.py b/test_markers_direct.py\nnew file mode 100644\nindex 000000000..2524de46c\n--- /dev/null\n+++ b/test_markers_direct.py\n@@ -0,0 +1,25 @@\n+import pytest\n+from _pytest.mark.structures import get_unpacked_marks\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+@pytest.mark.direct\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        pass\n+\n+# Test what get_unpacked_marks returns\n+print(\"get_unpacked_marks(TestDings):\", list(get_unpacked_marks(TestDings)))\n+print(\"TestDings.pytestmark:\", getattr(TestDings, 'pytestmark', []))\n+\n+# Let's trace through the MRO manually\n+print(\"\\nMRO traversal:\")\n+for cls in TestDings.__mro__:\n+    print(f\"  {cls.__name__}: pytestmark = {getattr(cls, 'pytestmark', [])}\")\n\\ No newline at end of file\ndiff --git a/test_markers_inheritance.py b/test_markers_inheritance.py\nnew file mode 100644\nindex 000000000..9e8d2ed13\n--- /dev/null\n+++ b/test_markers_inheritance.py\n@@ -0,0 +1,49 @@\n+import pytest\n+from _pytest.mark.structures import get_unpacked_marks\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        pass\n+\n+# Test what get_unpacked_marks returns\n+print(\"get_unpacked_marks(TestDings):\", list(get_unpacked_marks(TestDings)))\n+print(\"TestDings.pytestmark:\", getattr(TestDings, 'pytestmark', []))\n+\n+# Let's trace through the MRO manually\n+print(\"\\nMRO traversal:\")\n+for cls in TestDings.__mro__:\n+    print(f\"  {cls.__name__}: pytestmark = {getattr(cls, 'pytestmark', [])}\")\n+\n+# Let's see what happens with a custom get_unpacked_marks that follows MRO\n+def get_unpacked_marks_follow_mro(obj):\n+    \"\"\"Get all marks from an object and its base classes.\"\"\"\n+    marks = []\n+    if inspect.isclass(obj):\n+        for base in obj.__mro__:\n+            if hasattr(base, 'pytestmark'):\n+                base_marks = getattr(base, 'pytestmark', [])\n+                if not isinstance(base_marks, list):\n+                    base_marks = [base_marks]\n+                marks.extend(base_marks)\n+    else:\n+        # For non-class objects, just get their own marks\n+        mark_list = getattr(obj, \"pytestmark\", [])\n+        if not isinstance(mark_list, list):\n+            mark_list = [mark_list]\n+        marks.extend(mark_list)\n+    \n+    # Normalize the marks\n+    from _pytest.mark.structures import normalize_mark_list\n+    return list(normalize_mark_list(marks))\n+\n+import inspect\n+print(\"\\nCustom get_unpacked_marks_follow_mro(TestDings):\", get_unpacked_marks_follow_mro(TestDings))\n\\ No newline at end of file\ndiff --git a/test_markers_simple.py b/test_markers_simple.py\nnew file mode 100644\nindex 000000000..cdf49e879\n--- /dev/null\n+++ b/test_markers_simple.py\n@@ -0,0 +1,43 @@\n+import pytest\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        assert True\n+\n+# Let's also test with a simpler case\n+@pytest.mark.one\n+class ClassOne:\n+    pass\n+\n+@pytest.mark.two\n+class ClassTwo:\n+    pass\n+\n+class TestMultipleInheritance(ClassOne, ClassTwo):\n+    def test_multiple_inheritance(self):\n+        assert True\n+\n+# Test with deeper inheritance\n+@pytest.mark.base1\n+class Base1:\n+    pass\n+\n+@pytest.mark.base2\n+class Base2:\n+    pass\n+\n+class Middle(Base1):\n+    pass\n+\n+class TestDeepInheritance(Middle, Base2):\n+    def test_deep_inheritance(self):\n+        assert True\n\\ No newline at end of file\ndiff --git a/test_object_pytestmark.py b/test_object_pytestmark.py\nnew file mode 100644\nindex 000000000..381b050d6\n--- /dev/null\n+++ b/test_object_pytestmark.py\n@@ -0,0 +1,14 @@\n+import pytest\n+\n+# Check if object has pytestmark\n+print(\"hasattr(object, 'pytestmark'):\", hasattr(object, 'pytestmark'))\n+print(\"getattr(object, 'pytestmark', 'NO'):\", getattr(object, 'pytestmark', 'NO'))\n+\n+# Test with a simple class\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+print(\"\\nFoo.__mro__:\", Foo.__mro__)\n+for cls in Foo.__mro__:\n+    print(f\"  {cls}: hasattr('pytestmark') = {hasattr(cls, 'pytestmark')}\")\n\\ No newline at end of file\ndiff --git a/test_pytest_run.py b/test_pytest_run.py\nnew file mode 100644\nindex 000000000..294a8ebf1\n--- /dev/null\n+++ b/test_pytest_run.py\n@@ -0,0 +1,48 @@\n+import pytest\n+import sys\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        pass\n+\n+# Let's also test with a simpler case\n+@pytest.mark.one\n+class ClassOne:\n+    pass\n+\n+@pytest.mark.two\n+class ClassTwo:\n+    pass\n+\n+class TestMultipleInheritance(ClassOne, ClassTwo):\n+    def test_multiple_inheritance(self):\n+        pass\n+\n+# Test with deeper inheritance\n+@pytest.mark.base1\n+class Base1:\n+    pass\n+\n+@pytest.mark.base2\n+class Base2:\n+    pass\n+\n+class Middle(Base1):\n+    pass\n+\n+class TestDeepInheritance(Middle, Base2):\n+    def test_deep_inheritance(self):\n+        pass\n+\n+if __name__ == \"__main__\":\n+    # Run pytest programmatically\n+    sys.exit(pytest.main([__file__, \"-v\"]))\n\\ No newline at end of file\ndiff --git a/test_pytest_run2.py b/test_pytest_run2.py\nnew file mode 100644\nindex 000000000..cdf018963\n--- /dev/null\n+++ b/test_pytest_run2.py\n@@ -0,0 +1,67 @@\n+import pytest\n+import sys\n+\n+# Register custom markers\n+def pytest_configure(config):\n+    config.addinivalue_line(\"markers\", \"foo: foo marker\")\n+    config.addinivalue_line(\"markers\", \"bar: bar marker\")\n+    config.addinivalue_line(\"markers\", \"one: one marker\")\n+    config.addinivalue_line(\"markers\", \"two: two marker\")\n+    config.addinivalue_line(\"markers\", \"base1: base1 marker\")\n+    config.addinivalue_line(\"markers\", \"base2: base2 marker\")\n+\n+# Test case from PR description\n+@pytest.mark.foo\n+class Foo:\n+    pass\n+\n+@pytest.mark.bar\n+class Bar:\n+    pass\n+\n+class TestDings(Foo, Bar):\n+    def test_dings(self):\n+        pass\n+\n+# Let's also test with a simpler case\n+@pytest.mark.one\n+class ClassOne:\n+    pass\n+\n+@pytest.mark.two\n+class ClassTwo:\n+    pass\n+\n+class TestMultipleInheritance(ClassOne, ClassTwo):\n+    def test_multiple_inheritance(self):\n+        pass\n+\n+# Test with deeper inheritance\n+@pytest.mark.base1\n+class Base1:\n+    pass\n+\n+@pytest.mark.base2\n+class Base2:\n+    pass\n+\n+class Middle(Base1):\n+    pass\n+\n+class TestDeepInheritance(Middle, Base2):\n+    def test_deep_inheritance(self):\n+        pass\n+\n+if __name__ == \"__main__\":\n+    # Run pytest programmatically with -m to test marker selection\n+    # First test that all tests run without marker filtering\n+    print(\"=== Running all tests ===\")\n+    result1 = pytest.main([__file__, \"-v\"])\n+    print(\"\\n=== Testing with -m 'foo' (should match test_dings) ===\")\n+    result2 = pytest.main([__file__, \"-v\", \"-m\", \"foo\"])\n+    print(\"\\n=== Testing with -m 'bar' (should match test_dings) ===\")\n+    result3 = pytest.main([__file__, \"-v\", \"-m\", \"bar\"])\n+    print(\"\\n=== Testing with -m 'one' (should match test_multiple_inheritance) ===\")\n+    result4 = pytest.main([__file__, \"-v\", \"-m\", \"one\"])\n+    print(\"\\n=== Testing with -m 'two' (should match test_multiple_inheritance) ===\")\n+    result5 = pytest.main([__file__, \"-v\", \"-m\", \"two\"])\n\\ No newline at end of file\n"}