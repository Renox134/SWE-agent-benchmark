{"model_name_or_path": "openrouter_deepseek_deepseek-v3.2", "instance_id": "pydata__xarray-7233", "model_patch": "diff --git a/debug_issue.py b/debug_issue.py\nnew file mode 100644\nindex 00000000..4fd155d2\n--- /dev/null\n+++ b/debug_issue.py\n@@ -0,0 +1,34 @@\n+import numpy as np\n+import xarray as xr\n+\n+# Create the example from the PR description\n+da = xr.DataArray(np.arange(24), dims=[\"time\"])\n+da = da.assign_coords(day=365 * da)\n+ds = da.to_dataset(name=\"T\")\n+\n+print(\"Original dataset:\")\n+print(ds)\n+print(\"\\nCoordinates before coarsen.construct:\")\n+print(\"Coordinates:\", list(ds.coords))\n+print(\"Variables:\", list(ds.data_vars))\n+\n+# Let's trace through what happens\n+print(\"\\n\\nDebugging the issue:\")\n+print(\"self.obj.coords:\", list(ds.coords))\n+print(\"window_dim keys:\", [\"time\"])  # In the example, window_dim is {\"time\": (\"year\", \"month\")}\n+\n+# The issue is in line 976:\n+# should_be_coords = set(window_dim) & set(self.obj.coords)\n+# This only includes coordinates that are in window_dim (i.e., coordinates that are also dimensions)\n+# But 'day' is not a dimension, it's just a coordinate\n+\n+# Let's see what happens\n+window_dim = {\"time\": (\"year\", \"month\")}\n+should_be_coords = set(window_dim) & set(ds.coords)\n+print(\"\\nshould_be_coords calculation:\")\n+print(\"set(window_dim):\", set(window_dim))\n+print(\"set(ds.coords):\", set(ds.coords))\n+print(\"Intersection:\", should_be_coords)\n+\n+# So 'day' is not included in should_be_coords because it's not in window_dim\n+# This is the bug!\n\\ No newline at end of file\ndiff --git a/reproduce_issue.py b/reproduce_issue.py\nnew file mode 100644\nindex 00000000..c5e72e49\n--- /dev/null\n+++ b/reproduce_issue.py\n@@ -0,0 +1,29 @@\n+import numpy as np\n+import xarray as xr\n+\n+# Create the example from the PR description\n+da = xr.DataArray(np.arange(24), dims=[\"time\"])\n+da = da.assign_coords(day=365 * da)\n+ds = da.to_dataset(name=\"T\")\n+\n+print(\"Original dataset:\")\n+print(ds)\n+print(\"\\nCoordinates before coarsen.construct:\")\n+print(\"Coordinates:\", list(ds.coords))\n+print(\"Variables:\", list(ds.data_vars))\n+\n+# Apply coarsen.construct\n+result = ds.coarsen(time=12).construct(time=(\"year\", \"month\"))\n+\n+print(\"\\n\\nResult after coarsen.construct:\")\n+print(result)\n+print(\"\\nCoordinates after coarsen.construct:\")\n+print(\"Coordinates:\", list(result.coords))\n+print(\"Variables:\", list(result.data_vars))\n+\n+# Check if 'day' is still a coordinate\n+print(\"\\nIs 'day' still a coordinate?\", \"day\" in result.coords)\n+print(\"Is 'day' a data variable?\", \"day\" in result.data_vars)\n+\n+# Expected: 'day' should remain a coordinate\n+# Actual: 'day' becomes a data variable\n\\ No newline at end of file\ndiff --git a/test_fix.py b/test_fix.py\nnew file mode 100644\nindex 00000000..d1098a21\n--- /dev/null\n+++ b/test_fix.py\n@@ -0,0 +1,41 @@\n+import numpy as np\n+import xarray as xr\n+\n+# Create the example from the PR description\n+da = xr.DataArray(np.arange(24), dims=[\"time\"])\n+da = da.assign_coords(day=365 * da)\n+ds = da.to_dataset(name=\"T\")\n+\n+print(\"Original dataset:\")\n+print(ds)\n+print(\"\\nCoordinates before coarsen.construct:\")\n+print(\"Coordinates:\", list(ds.coords))\n+print(\"Variables:\", list(ds.data_vars))\n+\n+# Apply coarsen.construct\n+result = ds.coarsen(time=12).construct(time=(\"year\", \"month\"))\n+\n+print(\"\\n\\nResult after coarsen.construct:\")\n+print(result)\n+print(\"\\nCoordinates after coarsen.construct:\")\n+print(\"Coordinates:\", list(result.coords))\n+print(\"Variables:\", list(result.data_vars))\n+\n+# Check if 'day' is still a coordinate\n+print(\"\\nIs 'day' still a coordinate?\", \"day\" in result.coords)\n+print(\"Is 'day' a data variable?\", \"day\" in result.data_vars)\n+\n+# Expected: 'day' should remain a coordinate\n+# Actual: 'day' becomes a data variable\n+\n+# Let's also test with a DataArray directly\n+print(\"\\n\\n=== Testing with DataArray ===\")\n+da_with_coord = xr.DataArray(np.arange(24), dims=[\"time\"])\n+da_with_coord = da_with_coord.assign_coords(day=365 * da_with_coord)\n+print(\"Original DataArray:\")\n+print(da_with_coord)\n+\n+result_da = da_with_coord.coarsen(time=12).construct(time=(\"year\", \"month\"))\n+print(\"\\nResult after coarsen.construct:\")\n+print(result_da)\n+print(\"\\nIs 'day' still a coordinate in DataArray?\", \"day\" in result_da.coords)\n\\ No newline at end of file\n"}