{"model_name_or_path": "openrouter_deepseek_deepseek-v3.2", "instance_id": "scikit-learn__scikit-learn-10844", "model_patch": "diff --git a/reproduce_issue.py b/reproduce_issue.py\nnew file mode 100644\nindex 000000000..1ddef508e\n--- /dev/null\n+++ b/reproduce_issue.py\n@@ -0,0 +1,61 @@\n+import numpy as np\n+from sklearn.metrics.cluster import fowlkes_mallows_score\n+import warnings\n+\n+# Test 1: Basic test to ensure function works\n+print(\"Test 1: Basic test\")\n+labels_true = [0, 0, 1, 1]\n+labels_pred = [0, 0, 1, 1]\n+score = fowlkes_mallows_score(labels_true, labels_pred)\n+print(f\"Basic test score: {score}\")\n+\n+# Test 2: Create a case where pk * qk might overflow\n+print(\"\\nTest 2: Large dataset test\")\n+# Create a large dataset with many samples\n+n_samples = 100000\n+# Create labels that will generate large pk and qk values\n+labels_true = np.random.randint(0, 10, n_samples)\n+labels_pred = np.random.randint(0, 10, n_samples)\n+\n+# Enable warnings to catch RuntimeWarning\n+warnings.filterwarnings('error')\n+try:\n+    score = fowlkes_mallows_score(labels_true, labels_pred)\n+    print(f\"Large dataset score: {score}\")\n+except RuntimeWarning as e:\n+    print(f\"RuntimeWarning caught: {e}\")\n+    # Try to compute manually to see the issue\n+    from sklearn.metrics.cluster import contingency_matrix\n+    c = contingency_matrix(labels_true, labels_pred, sparse=True)\n+    tk = np.dot(c.data, c.data) - n_samples\n+    pk = np.sum(np.asarray(c.sum(axis=0)).ravel() ** 2) - n_samples\n+    qk = np.sum(np.asarray(c.sum(axis=1)).ravel() ** 2) - n_samples\n+    print(f\"tk: {tk}, pk: {pk}, qk: {qk}\")\n+    print(f\"pk * qk: {pk * qk}\")\n+    print(f\"Type of pk: {type(pk)}, Type of qk: {type(qk)}\")\n+    \n+    # Try the suggested fix\n+    if tk != 0:\n+        # Check if pk or qk is 0\n+        if pk > 0 and qk > 0:\n+            result = np.sqrt(tk / pk) * np.sqrt(tk / qk)\n+            print(f\"Result with suggested fix: {result}\")\n+        else:\n+            print(f\"pk or qk is 0: pk={pk}, qk={qk}\")\n+    else:\n+        print(\"tk is 0\")\n+\n+# Test 3: Edge case where tk = 0\n+print(\"\\nTest 3: Edge case tk = 0\")\n+labels_true = [0, 0, 1, 1]\n+labels_pred = [2, 3, 4, 5]  # Completely different clusters\n+score = fowlkes_mallows_score(labels_true, labels_pred)\n+print(f\"Score when tk=0: {score}\")\n+\n+# Test 4: Check if overflow actually happens with int32 limit\n+print(\"\\nTest 4: Testing overflow at 2^32\")\n+# Create values that would overflow 32-bit integers\n+pk_val = 2**31  # This squared would be 2^62\n+qk_val = 2**31\n+print(f\"pk * qk would be: {pk_val * qk_val}\")\n+print(f\"This is > 2^32: {pk_val * qk_val > 2**32}\")\n\\ No newline at end of file\n"}