{"model_name_or_path": "openrouter_qwen_qwen3-coder", "instance_id": "pydata__xarray-4094", "model_patch": "diff --git a/xarray/core/dataarray.py b/xarray/core/dataarray.py\nindex b0df8749..eaa28e81 100644\n--- a/xarray/core/dataarray.py\n+++ b/xarray/core/dataarray.py\n@@ -1961,7 +1961,14 @@ class DataArray(AbstractArray, DataWithCoords):\n         # pull variables out of datarray\n         data_dict = {}\n         for k in variables:\n-            data_dict[k] = self.sel({variable_dim: k}).squeeze(drop=True)\n+            # Select the variable and drop the stacked coordinate\n+            selected = self.sel({variable_dim: k})\n+            squeezed = selected.squeeze(drop=True)\n+            # Drop the stacked coordinate that's not a dimension, if it exists\n+            if dim in squeezed.coords:\n+                data_dict[k] = squeezed.drop_vars(dim)\n+            else:\n+                data_dict[k] = squeezed\n \n         # unstacked dataset\n         return Dataset(data_dict)\n"}