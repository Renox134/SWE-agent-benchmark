{"model_name_or_path": "openrouter_qwen_qwen3-coder", "instance_id": "pydata__xarray-2905", "model_patch": "diff --git a/xarray/core/variable.py b/xarray/core/variable.py\nindex 45553eb9..87eda607 100644\n--- a/xarray/core/variable.py\n+++ b/xarray/core/variable.py\n@@ -218,7 +218,13 @@ def as_compatible_data(data, fastpath=False):\n         data = np.timedelta64(getattr(data, \"value\", data), \"ns\")\n \n     # we don't want nested self-described arrays\n-    data = getattr(data, \"values\", data)\n+    # Only extract values from DataArray and Variable objects\n+    if hasattr(data, \"values\") and (hasattr(data, \"__class__\") and \n+                                    (data.__class__.__name__ in (\"DataArray\", \"Variable\") or\n+                                     (hasattr(data.__class__, \"__module__\") and \n+                                      data.__class__.__module__ is not None and\n+                                      \"xarray\" in data.__class__.__module__))):\n+        data = data.values\n \n     if isinstance(data, np.ma.MaskedArray):\n         mask = np.ma.getmaskarray(data)\n"}